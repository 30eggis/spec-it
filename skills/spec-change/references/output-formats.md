# Output Formats Reference

Detailed structures of files generated by `spec-change`.

---

## Analysis Results

### summary.md

Aggregated analysis from all analyzers.

```markdown
# Analysis Summary

Generated: 2026-01-30T12:00:00+09:00
Session: 20260130-123456

## Overview

| Check | Status | Issues | Action |
|-------|--------|--------|--------|
| Duplicates | ✅ pass | 0 | - |
| Conflicts | ⚠️ warn | 1 | Review needed |
| Clarity | ✅ pass | 8.5/10 | - |
| Consistency | ⚠️ warn | 2 | Use standard terms |
| Coverage | ✅ pass | 75% | - |
| Impact | ⚠️ medium | 4 files | See details |

## Duplicate Check (doppelganger)

No duplicates found.

## Conflict Check

**1 warning found:**

| Severity | Existing | Proposed | Resolution |
|----------|----------|----------|------------|
| medium | "Forms require confirmation" (CH-02:45) | "Auto-submit on change" | Clarify exception |

## Clarity Score: 8.5/10

- Completeness: 9/10
- Unambiguity: 7/10 (1 vague term)
- Testability: 9/10

**Suggestions:**
- Replace "quickly" with specific timing (e.g., "within 200ms")

## Consistency Issues

| Found | Expected | Severity |
|-------|----------|----------|
| "member" | "user" | medium |
| "dialog" | "modal" | low |

## Coverage: 75%

**Gaps identified:**
- Error handling for network failure
- Empty state for search results

## Affected Documents (Butterfly)

**Direct impact (4 files):**
- 01-chapters/decisions/CH-02.md
- 02-screens/wireframes/login-screen.md
- 03-components/new/auth-form.md
- 05-tests/scenarios/auth-test.md

**Indirect impact (1 file):**
- 02-screens/wireframes/dashboard-screen.md (review recommended)

## Recommended Actions

1. Address terminology: use "user" instead of "member"
2. Clarify conflict with CH-02 confirmation requirement
3. Proceed with changes after addressing above
```

---

### change-plan.md

Comprehensive change plan with diffs.

```markdown
# Change Plan

Generated: 2026-01-30T12:00:00+09:00
Session: 20260130-123456
Status: READY

---

## 1. Change Request Summary

**Action**: modify
**Target**: 01-chapters/decisions/CH-02.md
**Description**: Change authentication method from session-based to OAuth 2.0

---

## 2. Validation Results

| Check | Status | Issues | Action |
|-------|--------|--------|--------|
| Duplicates | ✅ pass | 0 | - |
| Conflicts | ⚠️ warn | 1 | Review CH-01 |
| Clarity | ✅ pass | 8.5/10 | - |
| Consistency | ⚠️ warn | 2 | Fixed in plan |
| Coverage | ✅ pass | 75% | - |
| Impact | ⚠️ medium | 4 files | See below |

### Warnings Addressed

1. **Terminology**: "member" → "user" (fixed in changes)
2. **Conflict**: Added exception clause for OAuth flow

---

## 3. Proposed Changes

### 3.1 Primary Change

**File**: `01-chapters/decisions/CH-02.md`
**Section**: Authentication Method

```diff
--- a/01-chapters/decisions/CH-02.md
+++ b/01-chapters/decisions/CH-02.md
@@ -45,7 +45,15 @@
 ## Authentication Method

-Selected: Session-based authentication with cookies
+Selected: OAuth 2.0 with JWT tokens
+
+### Rationale
+- Better mobile app support
+- Third-party integration ready
+- Industry standard security
+
+### Exception
+OAuth flows bypass the standard form confirmation requirement (ref: CH-01).
```

### 3.2 Dependent Change: Wireframe

**File**: `02-screens/wireframes/login-screen.md`

```diff
@@ -20,6 +20,10 @@
 ├─────────────────────────────────────────┤
 │  [Email Input                        ]  │
 │  [Password Input                     ]  │
+│                                         │
+│  ─────────── or ────────────            │
+│                                         │
+│  [Continue with Google              ]   │
+│  [Continue with GitHub              ]   │
 │                                         │
 │         [ Login ]                       │
```

### 3.3 Dependent Change: Component

**File**: `03-components/new/auth-form.md`

```diff
@@ -15,6 +15,8 @@
 ## Props

 | Prop | Type | Description |
+| providers | string[] | OAuth providers to display |
+| onOAuthClick | (provider: string) => void | OAuth button handler |
 | onSubmit | (data: FormData) => void | Form submit handler |
```

### 3.4 Dependent Change: Test

**File**: `05-tests/scenarios/auth-test.md`

```diff
@@ -10,6 +10,15 @@
 ## Scenarios

+### OAuth Login
+
+| Step | Action | Expected |
+|------|--------|----------|
+| 1 | Click "Continue with Google" | Redirect to Google OAuth |
+| 2 | Complete Google auth | Return to app with token |
+| 3 | Verify logged in state | User profile displayed |
+
 ### Email/Password Login
```

---

## 4. Impact Analysis

### Direct Impact (4 files)

| File | Change | Risk |
|------|--------|------|
| CH-02.md | Auth method update | Low |
| login-screen.md | Add OAuth buttons | Medium |
| auth-form.md | Add OAuth props | Medium |
| auth-test.md | Add OAuth scenarios | Low |

### Indirect Impact (1 file)

| File | Action | Risk |
|------|--------|------|
| dashboard-screen.md | Review auth state handling | Low |

### Dependency Graph

```
CH-02.md ──────────────────┐
    │                      │
    ├── login-screen.md    │
    │       │              │
    │       └── auth-form.md
    │              │
    └──────────────┼────── auth-test.md
                   │
         dashboard-screen.md (review)
```

---

## 5. Execution Order

1. `01-chapters/decisions/CH-02.md` (decision)
2. `02-screens/wireframes/login-screen.md` (wireframe)
3. `03-components/new/auth-form.md` (component)
4. `05-tests/scenarios/auth-test.md` (test)
5. Review: `02-screens/wireframes/dashboard-screen.md`

---

## 6. Risks & Mitigation

| Risk | Likelihood | Impact | Mitigation |
|------|------------|--------|------------|
| OAuth setup complexity | Medium | High | Document setup steps |
| Token refresh edge cases | Medium | Medium | Add to component spec |
| Test coverage gap | Low | Medium | Add OAuth mock tests |

---

## 7. Rollback Plan

If issues arise:

```bash
# Option 1: Git restore
git checkout -- 01-chapters/decisions/CH-02.md
git checkout -- 02-screens/wireframes/login-screen.md
# ... etc

# Option 2: Restore from backup
cp tmp/{sessionId}/_backup/* ./
```

---

## 8. Post-Change Checklist

- [ ] All diffs applied correctly
- [ ] No new conflicts introduced
- [ ] Traceability matrix updated
- [ ] Run `/spec-change --verify {sessionId}`
```

---

## Traceability Matrix (rtm.json)

```json
{
  "version": "1.0",
  "lastUpdated": "2026-01-30T12:00:00+09:00",
  "sessionId": "20260130-123456",

  "requirements": {
    "REQ-001": {
      "title": "User Authentication",
      "source": "00-requirements/requirements.md#authentication",
      "designLinks": ["CH-02", "CH-05"],
      "testLinks": ["TEST-001", "TEST-002"],
      "status": "implemented"
    }
  },

  "designs": {
    "CH-02": {
      "title": "Authentication Method",
      "source": "01-chapters/decisions/CH-02.md",
      "requirementLinks": ["REQ-001"],
      "wireframeLinks": ["login-screen", "signup-screen"],
      "componentLinks": ["auth-form"],
      "testLinks": ["TEST-001"]
    }
  },

  "coverage": {
    "requirements": { "total": 10, "withDesign": 10, "withTests": 8, "percentage": 80 },
    "designs": { "total": 8, "withTests": 7, "percentage": 87.5 }
  },

  "changeHistory": [
    {
      "timestamp": "2026-01-30T12:00:00+09:00",
      "action": "modify",
      "target": "CH-02",
      "changes": ["Updated authentication method to OAuth 2.0"],
      "affectedLinks": ["REQ-001 → CH-02", "CH-02 → login-screen"]
    }
  ]
}
```
